memspace = "0xEC4ABD0"
unsafeVar = "_end_bl"

if params.len != 1 or params[0] == "-h" or params[0] == "--help" then
	print("Firewall Crasher@router-kernel for v1.0.0")
	exit("<b>Usage: "+program_path.split("/")[-1]+" [ip_address]</b>")
end if

msflib = include_lib("/lib/metaxploit.so")
if not msflib then
	msflib = include_lib(current_path + "/metaxploit.so")
end if
if not msflib then exit("Error: Can't find metaxploit.so in the lib&local paths.")

RHOST = params[0]

sock = msflib.net_use(RHOST)
if not sock then
    exit("Error: Can't connect to the socket.")
else
	sock = sock.dump_lib.overflow(memspace,unsafeVar)
end if
exit("Program ended")
scan()